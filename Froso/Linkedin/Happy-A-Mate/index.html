<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>Happy-A-Mate!</title>
  </head>

  <body>
    <h2>Please input your LinkedIn credentials</h2>
    <form>
      <input type = "text"     id = "email"    placeholder="Email" autofocus>&nbsp&nbsp&nbsp
      <input type = "password" id = "password" placeholder="Password"><br><br>
      <input type = "file"     id = "excel"    accept = ".xlsx"><br><br>
      Record range <em>(Default:first 200 records)</em>
      <input type = "number"     id = "start"    placeholder="Starting row">&nbsp&nbsp&nbsp
      <input type = "number"     id = "end"      placeholder="Ending row"><br><br>
      <input type = "button"   id = "signin"   value = "Let's do it">
    </form>
    <script src="main.js"></script>
    
    <script>
      const {ipcRenderer} = require('electron')
      let email = "Null";
      let password = "Null";
      let excel = "Null";
      let startRow = "2";
      let endRow = "200";
      document.getElementById("signin").addEventListener('click', function() {
        email = document.getElementById("email").value;
        password = document.getElementById("password").value;
        excel = document.getElementById("excel").files[0].path;
        startRow = document.getElementById("start").value;
        endRow = document.getElementById("end").value;
        if (startRow == "" || startRow <= "1") {
          startRow = "2"
        }
        if (endRow == "") {
          endRow = "200"
        }
        ipcRenderer.send('email', email)
        ipcRenderer.send('password', password)
        ipcRenderer.send('excel', excel)
        ipcRenderer.send('start row', startRow)
        ipcRenderer.send('end row', endRow)
      });

      function func() {
        smashIt(email, password, excel, startRow, endRow)
      }
      document.getElementById("signin").addEventListener('click',function(){
        func();
      });
    </script>
  </body>
</html>


